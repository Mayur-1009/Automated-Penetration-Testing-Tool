import os
import requests

def sql_injection_scan(url):
    os.system(f"sqlmap -u {url} --batch --dbs")

def xss_scan(url):
    os.system(f"xsstrike -u {url}")

def csrf_scan(url):
    headers = ["Referer", "Origin"]
    missing_headers = []
    
    try:
        response = requests.get(url)
        for header in headers:
            if header not in response.headers:
                missing_headers.append(header)
        return missing_headers if missing_headers else ["CSRF Protection Present"]
    except Exception as e:
        return {"Error": str(e)}